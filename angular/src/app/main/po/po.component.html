<div [@routerTransition]>
        <div class="m-subheader ">
            <div class="d-flex align-items-center">
                <div class="mr-auto col-xs-6">
                    <h3 class="m-subheader__title m-subheader__title--separator">
                        <span>Contract</span>
                    </h3>
                </div>
                <div class="col-xs-6 text-right">
                    <button (click)="createPO()" *ngIf="isGranted('Pages.Administration.Contract.Create')"
                        class="btn btn-primary"><i class="fa fa-plus"></i>CreateNewContract</button>
                </div>
            </div>
        </div>
        <div class="m-content">
            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">
                    <form autocomplete="off">
                        <div class="m-form m-form--label-align-right" id="TextsFilterForm">
                            <div class="row align-items-center m--margin-bottom-10">
                                <div class="input-group">
                                    <div class="form-group" style="width: 15%; margin-left: 10px;">
                                        <label>Mã PO</label>
                                        <input [(ngModel)]="POId" name="POId" autofocus class="form-control" placeholder="Nhập mã PO" type="text">
                                    </div>
                                    <div class="form-group" style="width: 25%; margin-left: 10px;">
                                        <label>Tên đơn hàng</label>
                                        <input [(ngModel)]="orderName" name="orderName" autoFocus class="form-control" placeholder="Nhập tên đơn hàng" type="text">
                                    </div>
                                    <div class="form-group" style="width: 15%; margin-left: 10px;">
                                        <label>Số hợp đồng</label>
                                        <input [(ngModel)]="contractID" name="contractID" autofocus class="form-control" type="text">
                                    </div>   
                                    <div class="form-group" style="width: 15%; margin-left: 10px;">
                                        <label>Mã NCC</label>
                                        <input [(ngModel)]="vendorId" name="vendorId" autofocus class="form-control" placeholder="Nhập mã nhà cung cấp" type="text">
                                    </div>       
                                    <div class="form-group" style="width: 25%; margin-left: 10px;">
                                        <label>Loại PO</label>
                                        <select [(ngModel)]="type" name="Type" autofocus class="form-control">
                                            <option value="in" selected="selected">Trong kế hoạch</option>
                                            <option value="out">Ngoài kế hoạch</option>
                                        </select>   
                                    </div>     
                                    <span class="align-items-bottom">
                                        <button (click)="applyFilters()" class="btn btn-primary" type="submit">
                                            <i class="icon-refresh"></i>
                                            {{l("Refresh")}}</button>
                                    </span>                       
                                </div>                                                
                            </div>
                        </div>
                    </form>
                    <div class="row align-items-center">
                        <!--<Primeng-TurboTable-Start>-->
                        <div class="primeng-datatable-container" [busyIf]="primengTableHelper.isLoading">
                            <p-table #dataTable (onLazyLoad)="getPOs($event)" [value]="primengTableHelper.records"
                                rows="{{primengTableHelper.defaultRecordsCountPerPage}}" [paginator]="false" [lazy]="true"
                                [responsive]="primengTableHelper.isResponsive">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th pSortableColumn="contractID">
                                            Số TT
                                            <p-sortIcon field="contractID"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="name">
                                            Mã PO
                                            <p-sortIcon field="name"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="briefCaseID">
                                            Tên đơn hàng
                                            <p-sortIcon field="briefCaseID"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="deliveryTime">
                                            Số hợp đồng
                                            <p-sortIcon field="deliveryTime"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="vendorID">
                                            Ngày đặt hàng
                                            <p-sortIcon field="vendorID"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="vendorID">
                                            Tổng số tiền
                                            <p-sortIcon field="vendorID"></p-sortIcon>
                                        </th>
                                        <th>{{l('Edit')}}</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-record="$implicit" >
                                    <tr>
                                        <td>
                                            <span class="ui-column-title">Số TT</span>
                                            <span title="{{record.reportID}}">{{truncateString(record.reportID)}}</span>
                                        </td>
                                        <td>
                                            <span class="ui-column-title">Mã PO</span>
                                            <span title="{{record.pOID}}">{{truncateString(record.pOID)}}</span>
                                        </td>
                                        <td>
                                            <span class="ui-column-title">Tên đơn hàng</span>
                                            <span title="{{record.orderName}}">{{getBidNameFromId(record.orderName)}}</span>
                                        </td>
                                        <td>
                                            <span class="ui-column-title">Số hợp đồng</span>
                                            <span title="{{record.contractID}}">{{truncateString(record.contractID)}}</span>
                                        </td>
                                        <td>
                                            <span class="ui-column-title">Ngày đặt hàng</span>
                                            <span title="{{record.vendorID}}">{{truncateString(record.contractID)}}</span>
                                        </td>
                                        <td>
                                            <span class="ui-column-title">Tổng số tiền</span>
                                            <span title="{{record.vendorID}}">{{truncateString(record.contractID)}}</span>
                                        </td>
                                        <td>
                                            <button
                                                class="btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill"
                                                (click)="createOrEditModal.show(record.id)" title="{{l('Edit')}}">
                                                <i class="fa fa-edit" [attr.aria-label]="l('Edit')"></i>
                                            </button>
    
                                            <button
                                                class="btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill"
                                                (click)="deleteContract(record.id)" title="{{l('Delete')}}">
                                                <i class="fa fa-times" [attr.aria-label]="l('Delete')"></i>
                                            </button>
    
                                            <button
                                                class="btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill"
                                                (click)="viewContractModal.show(record.id)" title="{{l('View')}}">
                                                <i class="fa fa-eye" [attr.aria-label]="l('View')"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                            <div class="primeng-no-data" style="border: thin solid" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                {{l('NoData')}}
                            </div>
                            <div class="primeng-paging-container">
                                <p-paginator rows="{{primengTableHelper.defaultRecordsCountPerPage}}" #paginator
                                    (onPageChange)="getContracts($event)"
                                    [totalRecords]="primengTableHelper.totalRecordsCount"
                                    [rowsPerPageOptions]="primengTableHelper.predefinedRecordsCountPerPage">
                                </p-paginator>
                                <span class="total-records-count">
                                    {{l('TotalRecordsCount', primengTableHelper.totalRecordsCount)}}
                                </span>
                            </div>
                        </div>
                        <!--<Primeng-TurboTable-End>-->
                    </div>
                </div>
            </div>      
        </div>
        <createOrEditPOModal #createOrEditModal (modalSave)="reloadPage()"></createOrEditPOModal>
        <viewContractModal #viewContractModal></viewContractModal>
    </div>